<div class="card create-plan" id="create-plan-form">
  <div class="card-header">
    <h3><%= plan.new_record? ? "Create New Plan" : "Edit Plan" %></h3>
    <button class="close-btn" onclick="window.location='<%= dashboards_coach_path %>'">
      &times;
    </button>
  </div>
  <div style="margin-bottom: 20px;">
    <%= render 'dashboards/client/client', client: client, show_actions: false %>
  </div>

  <!-- views/plans/_form.html.erb -->
  <%= form_with model: plan, url: plan.persisted? ? plan_path(plan) : plans_path, method: plan.persisted? ? :patch : :post, local: true, class: "plan-form" do |f| %>
    <%= f.hidden_field :user_id, value: client.id %>

    <div class="form-group">
      <%= f.label :wellness_pillar, "Wellness Pillar" %>
      <%= f.select :wellness_pillar,
            Plan.wellness_pillars.keys.map { |k| [k.titleize, k] },
            { prompt: "Select a pillar..." },
            class: "form-control select-control" %>
    </div>

    <div class="form-group">
      <%= f.label :details, "Plan Details" %>
      <%= f.text_area :details, placeholder: "Enter plan details...", rows: 4, class: "form-control textarea-control" %>
    </div>

    <div class="form-row">
      <div class="form-group">
        <%= f.label :duration, "Due Date time" %>
        <%= f.datetime_local_field :duration, class: "form-control", min: Time.current.strftime("%Y-%m-%dT%H:%M") %>
      </div>

      <div class="form-group">
        <%= f.label :reminder_time, "Reminder (in minutes before due)" %>
        <%= f.number_field :reminder_time, class: "form-control", placeholder: "e.g. 60" %>
      </div>
    </div>

    <div class="form-actions">
      <%= f.submit plan.persisted? ? "Update Plan" : "+ Plan", class: "btn-plan" %>

      <% if plan.persisted? %>
        <%= link_to "Cancel", dashboards_coach_path(client_id: client.id), class: "btn-cancel" %>
      <% end %>
    </div>
  <% end %>
</div>
